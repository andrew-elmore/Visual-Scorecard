const axios = require('axios')

let scores = [[[41.393602112645866, -71.86236412395105],
[41.39310676037976, -71.86462154472434],
[41.3925532374815, -71.86578803200804],
[41.392472455801524, -71.86591976717439],]
    ,
    [[41.3931273698068, -71.86627495250482],
[41.393763265021484, -71.8646515277523],
    [41.394176072075304, -71.86252312976377],
    [41.39409909348478, -71.86209053664275],
    [41.39417660796266, -71.86203728875383],]
,
[[41.39453510015275, -71.86291374792074],
[41.396152228959984, -71.86329185936204],
[41.39724915973437, -71.86366077297025],
[41.39737913071942, -71.86358773094749],]
    ,
    [[41.397774048264175, -71.86375776903292],
    [41.398237116651714, -71.86257332802069],
    [41.39818144652729, -71.86248452813356],]
    ,
    [[41.39900274458005, -71.86264012743194],
    [41.401272047923754, -71.86194223613134],
    [41.402363865923625, -71.86126560128933],
    [41.40316833855467, -71.86068839243097],
    [41.40320438811574, -71.86059389779113],]
    ,
    [[41.403934415656735, -71.86058422455488],
    [41.40427109601407, -71.85820469877284],
    [41.403225614397634, -71.85817252908133],
    [41.40316817242459, -71.85808088206241],]
    ,
    [[41.40327797993773, -71.85878753045017],
    [41.40219940090996, -71.86017544806703],
    [41.4011600297303, -71.860981684034],
    [41.40103160816734, -71.86099355297851],]
    ,
    [[41.400612028157255, -71.86073372677762],
    [41.39952758470537, -71.86174804147649],
    [41.399388113347904, -71.86170784038755],]
    ,
    [[41.39767151170849, -71.86239880128456],
    [41.39595630188106, -71.86261649147961],
    [41.39491530285843, -71.8621014144103],
    [41.39479104113573, -71.86209963679516],]]

let shots = {}
let course = 'Elmridge White'
let score = {}
let startTime = Date.now()
scores.forEach((hole, idx) =>{
    shots[idx+1] = hole.map((shot, sIdx) => {
        let latitude = shot[0]
        let longitude = shot[1]
        return ({
            coords: {
                accuracy: 65,
                altitude: 0,
                altitudeAccuracy: 10,
                heading: -1,
                latitude: latitude,
                longitude: longitude,
                speed: -1
            },
            timestamp: startTime + (300000 * (sIdx + Object.values(score).length))
        })
    })
    score[idx + 1] = hole.length
})

console.log(shots)
console.log(score)


const axiosAirtable = axios.create({
    baseURL: 'https://api.airtable.com/v0/appcMdRfjvZEs0zeX',
    headers: {
        Authorization: 'Bearer keyHyLPdaCbr7AoxH'
    }
})


axiosAirtable.post('/scores', {
        "records": [
            {
                "fields": {
                    "date": JSON.stringify(startTime),
                    "user": JSON.stringify('demo@demo.com'),
                    "score": JSON.stringify(score),
                    "shots": JSON.stringify(shots),
                    "holes": JSON.stringify({"par":{"1":"4","2":"5","3":"4","4":"3","5":"5","6":"4","7":"4","8":"3","9":"4"},"yards":{"1":"365","2":"433","3":"344","4":"149","5":"576","6":"354","7":"365","8":"206","9":"370"}}),
                    "course": JSON.stringify(course),
                    "complete": JSON.stringify(true),
                    "strict": JSON.stringify(true),
                }
            }
        ]
    })


    